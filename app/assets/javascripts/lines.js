// this code was autogenerated from PJS
var sketchProc = (function($p) {
    var time = 0;
    var fill_color = 255;
    var render_width = window.innerWidth;
    var render_height = window.innerHeight;

    var spot_diameter = 7;

    var random_offset = 250;
    var max_points = 8;
    var width_base = 16;

    var coord_x = $p.createJavaArray('float', [max_points]);
    var coord_y = $p.createJavaArray('float', [max_points]);

    var record = false;
    function setup() {
        $p.frameRate(60);
        $p.size(render_width, render_height);

        random_coords();
    }
    $p.setup = setup;
    setup = setup.bind($p);

    function draw() {
        $p.background(fill_color);

        for (var i = 1; i < width_base; i++) {
            my_line_3(coord_x, coord_y, (width_base - i) * width_base - (width_base / 2), i % 2 == 0 ? 255 : 0);
        }
        for (var i = 1; i < max_points - 1; i++) {
            $p.randomSeed($p.millis() * 111);
            coord_y[i] = (coord_y[i] + i / 12.0 + 0.1) % render_height;
        }
        for (var i = 0; i < max_points; i++) {
            $p.randomSeed($p.millis() * 57);
            coord_x[i] = (coord_x[i] + i / 10.0 + 0.1) % render_width;
        }

        if (record) {
            record = false;
            $p.endRecord();
            $p.println("Recording: end");
            $p.println();
        }
    }
    $p.draw = draw;
    draw = draw.bind($p);

    function random_coords() {
        for (var i = 0; i < max_points; i++) {
            if (i > 0) {
                coord_x[i] = ($p.random(coord_x[i - 1] - random_offset, coord_x[i - 1] + random_offset) + render_width * 4) % render_width;
            } else {
                coord_x[i] = $p.random(render_width);
            }

            if (i > 0) {
                coord_y[i] = ($p.random(coord_x[i - 1] - random_offset, coord_x[i - 1] + random_offset) + render_height * 4) % render_height;
            }
            if (i == 0) {
                coord_y[i] = -100;
            }

            if (i == max_points - 1) {
                coord_y[i] = render_height + 100;
            }
        }
    }
    $p.random_coords = random_coords;
    random_coords = random_coords.bind($p);

    function my_spot(x, y, my_width, my_height) {
        $p.fill(0);
        $p.noStroke();
        $p.ellipse(x, y, my_width, my_height);
    }
    $p.my_spot = my_spot;
    my_spot = my_spot.bind($p);

    function my_line_3(coord_x, coord_y, weight, brightness) {
        $p.strokeJoin($p.MITER);
        $p.strokeCap($p.SQUARE);
        $p.noFill();

        $p.stroke(brightness, 255);
        $p.strokeWeight(weight);
        $p.beginShape();
        for (var i = 0; i < coord_x.length; i++) {
            $p.vertex(coord_x[i], coord_y[i]);
        }
        $p.endShape();
    }
    $p.my_line_3 = my_line_3;
    my_line_3 = my_line_3.bind($p);

    $p.resize = function(w, h){
      render_width = w;
      render_height = h;
      setup();
    }
});

$(document).ready(function(){
  var canvas = document.getElementById("canvas");
  var processingInstance = new Processing(canvas, sketchProc);
  processingInstance.resize(canvas.offsetWidth, canvas.offsetHeight);
  $('#banner').on('click', function(evt){
    processingInstance.random_coords();
  });
  $(window).on('resize', function(){
    processingInstance.resize(canvas.offsetWidth, canvas.offsetHeight);
  });
});
